# install.packages("readxl")
library(readxl)
library(ggplot2)
# Read the Excel file and specify the sheets to read
monthly    <- read_excel("ecb.CES_data_2024_monthly.august.xlsx", sheet = "ecb.CES_data_2024_monthly.en")
background <- read_excel("ecb.CES_data_2024_monthly.august.xlsx", sheet = "ecb.CES_data_background.en")
#print(dim(monthly)); print(dim(background))
#print(head(names(monthly), 20))
#print(head(names(background), 20))
merged <- merge(monthly, background, by = c('a0010',        # Respondent ID
'a0020'))    # Country code
dim(merged) # the two key columns are 'a0010' and 'a0020' are not duplicated, therefore we get 162 columns.
head(names(merged), 20)
# Filter for Austria (country code "AT")
austria_data <- subset(merged, a0020 == "AT")
dim(austria_data)
head(names(austria_data), 20)
### a) One year ahead inflation expectations 'c1120'
## patttern 1) extrapolation of expectations based on past inflation
## pattern 2)  Expectations on Education ISCED 'b210_prec'
# Check the distribution of education levels of respondents; 144 low, 474 medium, 325 high and no NAs.
table(austria_data$b2100_prec, useNA = "ifany")
# Calculate the average one year ahead inflation expectations by education level
aggregate(c1120 ~ b2100_prec, data = austria_data, FUN = mean, na.rm = TRUE)
# On Average for low the expected inflation is 6.18 %, for medium 4.17% and for high 4.49% one year ahead.
# This is in line with waht the paper argues, that lower educated people have higher inflation expectations.
ggplot(austria_data, aes(x = factor(b2100_prec,
levels = 1:3,
labels = c('Low','Middle','High')),
y = c1120)) +
geom_boxplot(fill = 'red') +
labs(x = "Education Level (ISCED)",
y = "One Year Ahead Inflation Expectations (c1120)",
title = "Inflation Expectations by Education Level in Austria (CES 2024)") +
theme_minimal()
# the plot also visuallieses that there are extreme outliers in all education groups, but the median is higher for low education.
# Regression where low education is the baseline category and we include medium and high as dummies.
# This tells the same story as the aggregate function above.
model_edu <- lm(c1120 ~ factor(b2100_prec), data = austria_data)
summary(model_edu)
q()
## pattern 2) extrapolation of expectations based on past prices in general – open end  "c1020" from scale -100 to 100.
cor_extrap <- cor(austria_data$c1020, austria_data$c1120, use = "complete.obs")
cor_extrap
## pattern 2) extrapolation of expectations based on past prices in general – open end  "c1020" from scale -100 to 100.
cor_extrap <- cor(austria_data$c1020, austria_data$c1120, use = "complete.obs")
cat("Correlation between expected and perceived past inflation (C1120 vs C1020):",
round(cor_extrap, 3), "\n")
cor_extrap
cat("Mean perceived past inflation (C1020):",
round(mean(austria_data$c1020, na.rm = TRUE), 2),
" | Mean expected (C1120):",
round(mean(austria_data$c1120, na.rm = TRUE), 2), "\n")
# Visualization: scatterplot with regression line
ggplot(austria_data, aes(x = c1020, y = c1120)) +
geom_point(alpha = 0.3, color = "darkblue") +
geom_smooth(method = "lm", se = FALSE, color = "red", lwd = 1.2) +
labs(x = "Perceived past 12-month inflation (%) (C1020)",
y = "Expected 1-year-ahead inflation (%) (C1120)",
title = "Austria: Extrapolation pattern (perceived vs. expected inflation)") +
theme_minimal()
library(ggplot2)
# Visualization: scatterplot with regression line
ggplot(austria_data, aes(x = c1020, y = c1120)) +
geom_point(alpha = 0.3, color = "darkblue") +
geom_smooth(method = "lm", se = FALSE, color = "red", lwd = 1.2) +
labs(x = "Perceived past 12-month inflation (%) (C1020)",
y = "Expected 1-year-ahead inflation (%) (C1120)",
title = "Austria: Extrapolation pattern (perceived vs. expected inflation)") +
theme_minimal()
d <- cat("Mean perceived past inflation (C1020):",
round(mean(austria_data$c1020, na.rm = TRUE), 2),
" | Mean expected (C1120):",
round(mean(austria_data$c1120, na.rm = TRUE), 2), "\n")
d
## pattern 2) extrapolation of expectations based on past prices in general – open end  "c1020" from scale -100 to 100.
cor_extrap <- cor(austria_data$c1020, austria_data$c1120, use = "complete.obs")
cor_extrap
# Visualization: scatterplot with regression line
ggplot(austria_data, aes(x = c1020, y = c1120)) +
geom_point(alpha = 0.3, color = "darkblue") +
geom_smooth(method = "lm", se = FALSE, color = "red", lwd = 1.2) +
labs(x = "Perceived past 12-month inflation (%) (C1020)",
y = "Expected 1-year-ahead inflation (%) (C1120)",
title = "Austria: Extrapolation pattern (perceived vs. expected inflation)") +
theme_minimal()
# Visualization: scatterplot with regression line
ggplot(austria_data, aes(x = c1020, y = c1120)) +
geom_point(alpha = 0.3, color = "darkblue") +
geom_smooth(method = "lm", se = FALSE, color = "red", lwd = 1.2) +
labs(x = "Perceived past 12-month inflation (%) (C1020)",
y = "Expected 1-year-ahead inflation (%) (C1120)",
title = "Austria: Extrapolation pattern (perceived vs. expected inflation)") +
theme_minimal()
# Visualization: scatterplot with regression line
ggplot(austria_data, aes(x = c1020, y = c1120)) +
geom_point(alpha = 0.3, color = "darkblue") +
geom_smooth(method = "lm", se = FALSE, color = "red", lwd = 1.2) +
labs(x = "Perceived past 12-month inflation (%) (C1020)",
y = "Expected 1-year-ahead inflation (%) (C1120)",
title = "Austria: Extrapolation pattern (perceived vs. expected inflation)") +
theme_minimal()
## pattern 2) extrapolation of expectations based on past prices in general – open end  "c1020" from scale -100 to 100.
cor_extrap <- cor(austria_data$c1020, austria_data$c1120, use = "complete.obs")
cor_extrap
# Visualization: scatterplot with regression line
ggplot(austria_data, aes(x = c1020, y = c1120)) +
geom_point(alpha = 0.3, color = "darkblue") +
geom_smooth(method = "lm", se = FALSE, color = "red", lwd = 1.2) +
labs(x = "Perceived past 12-month inflation (%) (C1020)",
y = "Expected 1-year-ahead inflation (%) (C1120)",
title = "Austria: Extrapolation pattern (perceived vs. expected inflation)") +
theme_minimal()
# gives a positive correlation of about 0.53, this shows that repondents who pelceive higher past inflation also expect higher future inflation.
# Visualization: scatterplot with regression line
ggplot(austria_data, aes(x = c1020, y = c1120)) +
geom_point(alpha = 0.3, color = "darkblue") +
geom_smooth(method = "lm", se = FALSE, color = "red", lwd = 1.2) +
labs(x = "Perceived past 12-month inflation (%) (C1020)",
y = "Expected 1-year-ahead inflation (%) (C1120)",
title = "Austria: Extrapolation pattern (perceived vs. expected inflation)") +
theme_minimal()
ggsave("extrapolation_plot_austria.png", width = 7, height = 5, dpi = 300)
# gives a positive correlation of about 0.53, this shows that repondents who pelceive higher past inflation also expect higher future inflation.
# Visualization: scatterplot with regression line
ggplot(austria_data, aes(x = c1020, y = c1120)) +
geom_point(alpha = 0.3, color = "darkblue") +
geom_smooth(method = "lm", se = FALSE, color = "red", lwd = 0.8) +
labs(x = "Perceived past 12-month inflation (%) (C1020)",
y = "Expected 1-year-ahead inflation (%) (C1120)",
title = "Austria: Extrapolation pattern (perceived vs. expected inflation)") +
theme_minimal()
ggsave("extrapolation_plot_austria.png", width = 7, height = 5, dpi = 300)
# On Average for low the expected inflation is 6.18 %, for medium 4.17% and for high 4.49% one year ahead.
# This is in line with waht the paper argues, that lower educated people have higher inflation expectations.
ggplot(austria_data, aes(x = factor(b2100_prec,
levels = 1:3,
labels = c('Low','Middle','High')),
y = c1120)) +
geom_boxplot(fill = 'red') +
labs(x = "Education Level (ISCED)",
y = "One Year Ahead Inflation Expectations (c1120)",
title = "Inflation Expectations by Education Level in Austria (CES 2024)") +
theme_minimal()
ggsave("education_plot_austria.png", width = 7, height = 5, dpi = 300)
# On Average for low the expected inflation is 6.18 %, for medium 4.17% and for high 4.49% one year ahead.
# This is in line with waht the paper argues, that lower educated people have higher inflation expectations.
ggplot(austria_data, aes(x = factor(b2100_prec,
levels = 1:3,
labels = c('Low','Middle','High')),
y = c1120)) +
geom_boxplot(fill = 'red') +
labs(x = "Education Level (ISCED)",
y = "One Year Ahead Inflation Expectations (c1120)",
title = "Inflation Expectations by Education Level in Austria (CES 2024)") +
theme_minimal()
ggsave("education_plot_austria.png", width = 7, height = 5, dpi = 300)
# gives a positive correlation of about 0.53, this shows that repondents who pelceive higher past inflation also expect higher future inflation.
# Visualization: scatterplot with regression line
p_extr <- ggplot(austria_data, aes(x = c1020, y = c1120)) +
geom_point(alpha = 0.3, color = "darkblue") +
geom_smooth(method = "lm", se = FALSE, color = "red", lwd = 0.8) +
labs(x = "Perceived past 12-month inflation (%) (C1020)",
y = "Expected 1-year-ahead inflation (%) (C1120)",
title = "Austria: Extrapolation pattern (perceived vs. expected inflation)") +
theme_minimal()
ggsave("extrapolation_plot_austria.png",plot = p_extr, width = 7, height = 5, dpi = 300)
# On Average for low the expected inflation is 6.18 %, for medium 4.17% and for high 4.49% one year ahead.
# This is in line with waht the paper argues, that lower educated people have higher inflation expectations.
p_edu <-ggplot(austria_data, aes(x = factor(b2100_prec,
levels = 1:3,
labels = c('Low','Middle','High')),
y = c1120)) +
geom_boxplot(fill = 'red') +
labs(x = "Education Level (ISCED)",
y = "One Year Ahead Inflation Expectations (c1120)",
title = "Inflation Expectations by Education Level in Austria (CES 2024)") +
theme_minimal()
ggsave("education_plot_austria.png",plot = p_edu, width = 7, height = 5, dpi = 300)
q()
library(dplyr)
library(tidyr)
library(ggplot2)
## load data
df <- read.csv2("data_assign4.csv", header = TRUE, sep = ";", dec = ",")
# Extract metadata
meta_country <- as.character(df[1, ]) # Country names
meta_series <- as.character(df[2, ]) # Series type (Interest, HICP, GDP)
# Remove metadata rows
data <- df[-c(1, 2), ]
# Build clean column names: "Country||Series"
names(data) <- paste0(meta_country, "||", meta_series)
# Fix Year column
names(data)[1] <- "Year"
data$Year <- as.integer(data$Year)
# Convert to long format
df_long <- data %>%
pivot_longer(
cols      = -Year,
names_to  = c("Country", "Series"),
names_sep = "\\|\\|",
values_to = "value"
) %>%
mutate(
value = as.numeric(gsub(",", ".", value, fixed = TRUE))
) %>%
# Map the descriptive Series names to i / hicp / gdp
mutate(
TIME_PERIOD = case_when(
Series == "Interest rates, Short term nominal (ISN)" ~ "i",
grepl("^HICP - Overall index", Series) ~ "hicp",
grepl("^Gross domestic product at market prices", Series) ~ "gdp",
TRUE ~ NA_character_
)
) %>%
# Keep only the three series we care about
filter(!is.na(TIME_PERIOD))
# Keep only the true series (drop duplicate EU interest rates, long-term rates, etc.)
df_long <- df_long %>%
filter(
(TIME_PERIOD == "i" & Series == "Interest rates, Short term nominal (ISN)") |
(TIME_PERIOD == "hicp" & grepl("^HICP - Overall index", Series)) |
(TIME_PERIOD == "gdp" & grepl("^Gross domestic product at market prices", Series))
)
# From here on, use `TIME PERIOD` instead of `Series`
df_tidy <- df_long %>%
mutate(
Country = ifelse(
grepl("^EU", Country, ignore.case = TRUE),
Country,
gsub("\\s*\\(.*\\)", "", Country)
)
)
df_tidy <- df_tidy %>%
mutate(
Country = case_when(
# 1) European Union -> EU
grepl("^European Union", Country, ignore.case = TRUE) ~ "EU",
# 2) EU, EU(…) etc. -> EU  (but NOT "Euro area")
grepl("^EU\\b", Country, ignore.case = TRUE) ~ "EU",
# 3) Euro area (…) or Euro area 17/19/20 (…) -> keep "Euro area", "Euro area 17", etc.
grepl("^Euro area", Country, ignore.case = TRUE) ~
trimws(gsub("\\s*\\(.*\\)", "", Country)),
# 4) Czech Republic -> Czechia
Country == "Czech Republic" ~ "Czechia",
# 5) All other countries: drop parentheses like "(AT)"
TRUE ~ trimws(gsub("\\s*\\(.*\\)", "", Country))
)
) %>%
group_by(Year, Country, `TIME_PERIOD`) %>%
summarise(
value = mean(value, na.rm = TRUE),
.groups = "drop"
) %>%
arrange(Country, Year, `TIME_PERIOD`)
View(df_tidy)
# Pivot to wide format: one row per Year–Country, columns i, hicp, gdp
df_panel <- df_tidy %>%
pivot_wider(
id_cols = c(Year, Country),
names_from = `TIME_PERIOD`,
values_from = value
) %>%
arrange(Country, Year) # within each country: 2000, 2001, 2002, ...
## helper function for missing values
fix_na_seq <- function(x) {
n <- length(x)
if (n <= 1) {
return(x)
}
i <- 1
while (i <= n) {
if (is.na(x[i])) {
# find end of this NA-run
j <- i
while (j + 1 <= n && is.na(x[j + 1])) {
j <- j + 1
}
run_len <- j - i + 1
if (run_len == 1) {
# Case: single NA
if (i == 1 && !is.na(x[i + 1])) {
# leading single NA -> take next value
x[i] <- x[i + 1]
} else if (i == n && !is.na(x[i - 1])) {
# trailing single NA -> take previous value
x[i] <- x[i - 1]
} else if (i > 1 && i < n && !is.na(x[i - 1]) && !is.na(x[i + 1])) {
# interior single NA -> average of neighbors
x[i] <- (x[i - 1] + x[i + 1]) / 2
}
# else: one side is NA too -> leave as NA
} else {
# run_len > 1 -> leave all these NAs unchanged
}
i <- j + 1
} else {
i <- i + 1
}
}
x
}
### Apply missing value fixing per Country
group_by(Country) %>%
arrange(Year, .by_group = TRUE) %>%
mutate(
i    = fix_na_seq(i),
hicp = fix_na_seq(hicp),
gdp  = fix_na_seq(gdp)
) %>%
ungroup()
View(df_panel)
## add column real interest rate
df_panel <- df_panel %>%
mutate(
r = i - hicp
)
# create a new country in column Countrey that uses gdp from Euro area 20 and i and hicp from Euro area
# 1. Take Euro area i, hicp, r
ea <- df_panel %>%
filter(Country == "Euro area") %>%
select(Year, i, hicp, r)
View(df)
View(data)
